<!doctype html><html lang=en><head><title>Using ProcMon to Troubleshoot Printing Freezes in Word :: RoninSec - Cyber Journal</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Diagnosing a strange Microsoft Word printing freeze using Process Monitor (ProcMon) — from initial symptoms to discovering an orphaned SID in printer permissions."><meta name=keywords content="ProcMon,Word not responding,printing freeze,spooler,unknown SID,ACL,USB printer"><meta name=robots content="noodp"><link rel=canonical href=https://BioCreates.github.io/posts/procmon-printing-freeze/><link rel=stylesheet href=https://BioCreates.github.io/css/custom.min.2707a48b3c4cb7c495ff47581f9533e9f6f3ffeb9c1f0bb8ac2ba5ae94c0f96b.css><link rel=stylesheet href=https://BioCreates.github.io/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css><link rel=stylesheet href=https://BioCreates.github.io/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css><link rel=stylesheet href=https://BioCreates.github.io/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css><link rel=stylesheet href=https://BioCreates.github.io/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css><link rel=stylesheet href=https://BioCreates.github.io/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css><link rel=stylesheet href=https://BioCreates.github.io/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css><link rel=stylesheet href=https://BioCreates.github.io/css/main.min.36833afd348409fc6c3d09d0897c5833d9d5bf1ff31f5e60ea3ee42ce2b1268c.css><link rel=stylesheet href=https://BioCreates.github.io/css/menu.min.3c17467ebeb3d38663dce68f71f519901124fa5cbb4519b2fb0667a21e9aca39.css><link rel=stylesheet href=https://BioCreates.github.io/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css><link rel=stylesheet href=https://BioCreates.github.io/css/post.min.e6dddd258e64c83e05cec0cd49c05216742d42fc8ecbfbe6b67083412b609bd3.css><link rel=stylesheet href=https://BioCreates.github.io/css/syntax.min.a0773cce9310cb6d8ed23e50f005448facf29a53001b57e038828daa466b25c0.css><link rel=stylesheet href=https://BioCreates.github.io/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css><link rel=stylesheet href=https://BioCreates.github.io/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css><link rel=stylesheet href=https://BioCreates.github.io/terminal.css><link rel="shortcut icon" href=https://BioCreates.github.io/favicon.png><link rel=apple-touch-icon href=https://BioCreates.github.io/apple-touch-icon.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Using ProcMon to Troubleshoot Printing Freezes in Word"><meta property="og:description" content="Diagnosing a strange Microsoft Word printing freeze using Process Monitor (ProcMon) — from initial symptoms to discovering an orphaned SID in printer permissions."><meta property="og:url" content="https://BioCreates.github.io/posts/procmon-printing-freeze/"><meta property="og:site_name" content="RoninSec - Cyber Journal"><meta property="og:image" content="https://BioCreates.github.io/posts/procmon-printing-freeze/img/procmon-printing-freeze-banner.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2025-10-11 12:00:00 -0400 -0400"><link rel=stylesheet href=/css/custom.min.2707a48b3c4cb7c495ff47581f9533e9f6f3ffeb9c1f0bb8ac2ba5ae94c0f96b.css integrity="sha256-JwekizxMt8SV/0dYH5Uz6fbz/+ucHwu4rCulrpTA+Ws="></head><body><div class="container center"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>RoninSec</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://BioCreates.github.io/posts/procmon-printing-freeze/>Using ProcMon to Troubleshoot Printing Freezes in Word</a></h1><div class=post-meta><time class=post-date>2025-10-11</time><span class=post-author>RoninSec</span><span class=post-reading-time>3 min read (549 words)</span></div><span class=post-tags>#<a href=https://BioCreates.github.io/tags/procmon/>procmon</a>&nbsp;
#<a href=https://BioCreates.github.io/tags/troubleshooting/>troubleshooting</a>&nbsp;
#<a href=https://BioCreates.github.io/tags/windows-printing/>windows-printing</a>&nbsp;
#<a href=https://BioCreates.github.io/tags/office/>office</a>&nbsp;
#<a href=https://BioCreates.github.io/tags/sysinternals/>sysinternals</a>&nbsp;
</span><img src=/posts/procmon-printing-freeze/img/procmon-printing-freeze-banner.png class=post-cover alt="Using ProcMon to Troubleshoot Printing Freezes in Word" title="Cover Image"><div class=post-content><div><h1 id=using-procmon-to-troubleshoot-printing-freezes-in-word>Using ProcMon to Troubleshoot Printing Freezes in Word<a href=#using-procmon-to-troubleshoot-printing-freezes-in-word class=hanchor arialabel=Anchor>#</a></h1><p>Recently, I worked a case where a user’s brand-new PC would <strong>freeze in Word every time they tried to print</strong>. The app would hang with “Not Responding” for several minutes before the job finally pushed through.</p><p>At first glance, this looked like a driver or spooler problem — but the actual root cause was something much stranger. Here’s how I approached it, and how Procmon helped me narrow things down.</p><hr><h2 id=reproducing-the-problem>Reproducing the Problem<a href=#reproducing-the-problem class=hanchor arialabel=Anchor>#</a></h2><ul><li>User: Jake, workstation <strong>WS01</strong></li><li>Symptom: Word freezes with <em>Not Responding</em> when printing to an HP OfficeJet (USB-connected).</li><li>Restarting the PC, repairing Office, and resetting the spooler service made no difference.</li><li>Even re-installing the printer via HP Smart with the correct driver didn’t help.</li></ul><p>At this point, it was time to dig deeper with <strong>Process Monitor (Procmon)</strong>.</p><hr><h2 id=using-procmon-to-capture-the-freeze>Using Procmon to Capture the Freeze<a href=#using-procmon-to-capture-the-freeze class=hanchor arialabel=Anchor>#</a></h2><h3 id=step-1--setup>Step 1 – Setup<a href=#step-1--setup class=hanchor arialabel=Anchor>#</a></h3><ul><li>Downloaded <strong>Procmon</strong> from Sysinternals.</li><li>Started capture, cleared buffer, enabled <em>Drop Filtered Events</em> and <em>Advanced Output</em>.</li><li>Added filters for:<ul><li><code>WINWORD.EXE</code></li><li><code>spoolsv.exe</code> (Print Spooler)</li><li><code>splwow64.exe</code> (32-bit/64-bit broker)</li><li><code>PrintIsolationHost.exe</code></li><li><code>Path contains \spool\PRINTERS</code> (spool files)</li></ul></li></ul><h3 id=step-2--reproduce>Step 2 – Reproduce<a href=#step-2--reproduce class=hanchor arialabel=Anchor>#</a></h3><ul><li>Hit Print in Word, waited for the freeze.</li><li>Stopped capture as soon as the print went through.</li></ul><h3 id=step-3--analyze>Step 3 – Analyze<a href=#step-3--analyze class=hanchor arialabel=Anchor>#</a></h3><ul><li>Sorted by <strong>Duration</strong> to look for slow events.</li><li>Found lots of activity on <code>C:\Windows\System32\spool\PRINTERS\00003.SPL</code> and <code>00003.SHD</code>.</li><li>Word was writing spool data, Spooler was creating and cleaning up the job files.</li><li>Importantly: <strong>no abnormal access denials, no unusually long delays, no AV filters locking the files</strong>.</li></ul><hr><h2 id=what-the-logs-showed>What the Logs Showed<a href=#what-the-logs-showed class=hanchor arialabel=Anchor>#</a></h2><p>Procmon confirmed that:</p><ul><li>Word was correctly creating and writing <code>.SPL</code> spool files.</li><li>Spooler was processing those files normally.</li><li>No evidence of corruption, driver DLL misbehavior, or antivirus blocking the spool folder.</li></ul><p>So while the logs didn’t reveal the smoking gun, they <strong>helped rule out</strong> several likely suspects.</p><hr><h2 id=the-real-culprit-an-unknown-sid>The Real Culprit: An Unknown SID<a href=#the-real-culprit-an-unknown-sid class=hanchor arialabel=Anchor>#</a></h2><p>With drivers, spooler, and AV cleared, I dug into the <strong>printer’s security properties</strong>.</p><p>There, I found an <strong>Unknown SID</strong> listed in the ACL — likely a leftover from a profile copied from an old machine.</p><p>Every time Word tried to print, Windows would attempt to resolve that orphaned SID to check permissions. Since the account no longer existed, the lookup would stall, causing Word to hang until the check timed out.</p><p>Removing the invalid SID from the printer’s Security tab fixed the issue immediately. Printing returned to normal with no freezes.</p><hr><h2 id=key-takeaways>Key Takeaways<a href=#key-takeaways class=hanchor arialabel=Anchor>#</a></h2><ul><li><strong>Procmon doesn’t always give you the direct answer</strong> — but it’s invaluable for ruling things out. In this case, it showed spooler I/O behaving normally, which pushed me to check permissions.</li><li><strong>Unknown SIDs in printer ACLs can cause hangs.</strong> Windows will pause while it tries to resolve them, even on a simple USB printer.</li><li>Always consider ACLs/security properties when troubleshooting print freezes — not just drivers, spooler, or AV.</li></ul><hr><h2 id=summary>Summary<a href=#summary class=hanchor arialabel=Anchor>#</a></h2><p><strong>Symptom:</strong> Word froze when printing, showing <em>Not Responding</em>.<br><strong>Investigation:</strong> Procmon trace showed normal spool file behavior, no clear failures.<br><strong>Root Cause:</strong> Printer ACL contained an invalid/unknown SID, stalling permission checks.<br><strong>Resolution:</strong> Removed the unknown SID → printing worked instantly.</p><hr><p>👉 Have you ever had a troubleshooting case where Procmon didn’t show the answer directly, but helped steer you to the real fix? This was a perfect example for me — sometimes the “negative result” (what’s <em>not</em> broken) is just as valuable.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h></span><hr></div><div class=pagination__buttons><a href=https://BioCreates.github.io/posts/detecting-persistence-wazuh-sysmon/ class="button inline prev">&lt; [<span class=button__text>Detecting Persistence with Wazuh + Sysmon</span>]
</a>::
<a href=https://BioCreates.github.io/posts/stolen-szechuan-sauce-journey/ class="button inline next">[<span class=button__text>DFIR Journey: DC Forensics — Case of the Szechuan Sauce</span>] ></a></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2025 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>